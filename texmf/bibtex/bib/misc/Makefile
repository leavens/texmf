# $Id$

COMPRESS = gzip -S ".Z"

REALBIBS = datatypes.bib old-datatypes.bib distrib.bib \
	languages.bib se.bib etc.bib
# In bibtex, cross references come after entries that reference it,
# so it's important to have proceedings.bib be *last*.
BIBS = journal-abbrevs.bib $(REALBIBS) proceedings.bib 

all: all.bib

all.bib: $(BIBS)
	rm -f $@
	echo '%% Do not edit this file directly, it is automatically generated' > $@
	cat $(BIBS) >> $@
	chmod a-w $@

# The following seems useful for Texlipse (at least version 1.1)
std: all-with-std.bib

all-with-std.bib: $(BIBS) journal-abbrevs-std.bib
	rm -f $@
	echo '%% Do not edit this file directly, it is automatically generated' > $@
	cat journal-abbrevs-std.bib $(BIBS) >> $@
	chmod a-w $@

names:
	@echo $(BIBS)

# The following is for Gary's use, most people won't be able to use it
web garys-web: $(HOME)/WWW/biblio.bib.Z send-to-iastate

# goes with web, but the PHP scripting is currently broken.
#	cd $(HOME)/WWW; \
#	for f in all.bib $(REALBIBS) ; do php -q bibidx.php $$f; done

$(HOME)/WWW/biblio.bib.Z: $(BIBS) leavens.bib Makefile
	$(MAKE) all.bib
	cp -f all.bib biblio.bib
	rm -f biblio.bib.Z
	$(COMPRESS) biblio.bib
	mv -f biblio.bib.Z $(HOME)/WWW/

send-to-iastate: leavens.bib
	scp -p leavens.bib pyrite.cs.iastate.edu:/auto/ftp/pub/leavens/
